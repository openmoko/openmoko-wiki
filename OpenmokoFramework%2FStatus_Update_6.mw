<div style="text-align: center; font-weight: bold; font-size: x-large; margin-bottom:1em">Openmoko Framework Team Status Report 2009.2.2</div>

Hi guys! This is the sixth Openmoko Framework Team Status update, featuring our fifth milestone release and more.

For the general motivation, the goals, and the way we are doing our work, please see [[OpenmokoFramework]].

{{FSO}}


== People & Organization ==

No changes here. Current team still consists of Mickey, Jan, Daniel, and Stefan.

== DBus APIs ==

All the public DBus API are documented on the official [http://docs.freesmartphone.org freesmartphone.org API reference] site. XML-API files for generating language bindings are available from the [http://git.freesmartphone.org/?p=specs.git;a=tree;f=xml git tree].

* The GSM API (org.freesmartphone.GSM.*) has received minor updates and is now considered version 0.9. One notable addition is [http://git.freesmartphone.org/?p=specs.git;a=blob_plain;f=html/org.freesmartphone.GSM.Monitor.html org.freesmartphone.GSM.Monitor], which is an interface for GSM monitoring, i.e. gathering diagnostic information over the serving cell and the neighbour cells. 

* The Device API (org.freesmartphone.Device.*) has received minor updates and is now considered 0.8. One notably addition is [http://git.freesmartphone.org/?p=specs.git;a=blob_plain;f=html/org.freesmartphone.Device.Audio.html#PlaySound org.freesmartphone.Device.Audio.PlaySound] which gained parameters for looping and length.

* The Usage API got the new signal [http://git.freesmartphone.org/?p=specs.git;a=blob_plain;f=html/org.freesmartphone.Usage.html;hb=HEAD#SystemAction org.freesmartphone.Usage.SystemAction] which is sent on suspend, resume, shutdown, etc.

* org.freesmartphone.Objects.ListObjectsByInterface has been generalized, it gained an additional bus name parameter and is now called org.freesmartphone.DBus.ListObjectsByInterface. It's now useful also outside FSO.

* org.freesmartphone.Network has been added with the call [http://git.freesmartphone.org/?p=specs.git;a=blob_plain;f=html/org.freesmartphone.Network.html;hb=HEAD#StartConnectionSharingWithInterface org.freesmartphone.StartConnectionSharingWithInterface]. NOTE: This will not be a full fledged networking interface, but rather a high level API complementing org.moblin.connman.

* The opim API has reached this milestone, although it's still too much in flux to document it. Instead, please give it a try and join our discussions at the smartphones-standards list.

* [http://git.freesmartphone.org/?p=specs.git;a=blob_plain;f=html/org.freesmartphone.Time.Alarm.html;hb=HEAD org.freesmartphone.Time.Alarm] has made its debut as an interface for registering / clearing wake up alarms.

== Implementations ==

'''Freesmartphone.org Framework Image -- '' (Milestone V)'''

This is the fifth milestone release of the framework and the diagnostic application 'Zhone'. While we announced that we are going to phase Zhone out as phone application, it found new live as a diagnostic application, i.e. for GPS and GSM monitoring. There might be more to come, depending on our spare time...

Framework milestones currently ship in three forms:

# fso-console-image: An FSO-compliant image featuring no user interface manager.
# fso-illume-image: An FSO-compliant image featuring the X-Window system with the Enlightenment-based Illume window manager.
# fso-zhone-image: An FSO-compliant image featuring the X-Window system with the Enlightenment-based Illume and the Zhone diagnostic application.

===Thanks===

Thanks to all our contributors, especially the testers and the people who build stuff on top of the freesmartphone.org APIs. Thanks, guys -- you rock!

===Purpose===

A flashable image that implements the freesmartphone.org APIs, serving as the basis for application development.

=== What's new since Milestone IV ===

'''Note: These are only the highlights. See the [http://git.freesmartphone.org gitweb] commit logs for the gory details...'''

* ogsmd
** Implement org.freesmartphone.GSM.Network.GetCountryCode() -> ss
** Revamped callhandling. Refactored the state-based call handler from TI Calypso (and Freescale Neptune) into a generic class that will be used from all modem abstractions. Ported singleline to use the new call handler. More tests needed for TI Calypso and Freescale Neptune.
** Start with CINTERION MC75 support
** Implement org.freesmartphone.GSM.Device.[Get|Set]SpeakerVolume
** Implemented org.freesmartphone.GSM.Device.[Get|Set]MicrophoneMuted
** Added 'cid' and 'lac' results to org.freesmartphone.GSM.Network.GetStatus()
** Implemented org.freesmartphone.GSM.SIM.GetIssuer() NOTE: Clients can now show the Mobile Virtual Network Operator instead of the actual service provider, if they want to.
** Added codeToOperator function and a mobile network operator database
** [FREESCALE NEPTUNE] Query our MNO database to show the alphanumeric operator name.
** Implemented org.freesmartphone.GSM.PDP.NetworkStatus()
** Implemented org.freesmartphone.GSM.PDP.GetNetworkStatus()
** Implemented org.freesmartphone.GSM.Network.TimeZoneReport()
** Refactored PDP handling for more stability
** Implemented org.freesmartphone.GSM.Phone.[Start|Stop]AutoRegister() and its signal org.freesmartphone.GSM.Phone.ServiceStatus() This is a convenient way to ensure that ogsmd always tries to unlock the SIM and register with a provider, if necessary. (Corresponding functionality for Gprs is under discussion).
** Create qualcomm_msm modem abstraction based on singleline with minimal changes.
** Added network access type to Provider Info (WARNING, breaks API!)
** Support for Ericsson F3507g modem (as found in Thinkpads)
** Preliminary support for Option UMTS cards
** Added TI-Calypso specific configuration option "ti_calypso_dsp_mode" to configure audio enhancements. Documentation for this option has been added to the sample configuration file.
** Implemented org.freesmartphone.GSM.Monitoring.* as stub erroring out with org.freesmartphone.GSM.UnsupportedCommand.
** [TI CALYPSO] Implemented the new monitoring API: org.freesmartphone.GSM.Monitoring.Get{Serving|Neighbour}CellInformation
** [TI CALYPSO] DSP command gets now resent before call setup.
** Implemented org.freesmartphone.GSM.Phone.StartAutoOnline(apn, user, password) This works the same way as StartAutoRegister(pin), trying to keep the connection online.

* ogpsd
**  Add support for debugging via UDP

* odeviced
** Added kernel26 option called 'fb_blank' (default=1). If you suffer from the Om bug WSOD (white screen of death), try setting this option to 0.
** Added two new resources: 'CPU' and 'Display': Requesting the CPU resource will prevent the idle notifier from falling into the 'suspend' state, requesting the Display resource will prevent the idle notifier from falling into the 'idle_dim' (and following) state(s). With these two resource, it now takes only one additional rule to prevent the system from suspending while on a call or a musicplayer is playing. 
** Implemented org.freesmartphone.Device.LED.SetNetworking(s,s) -> ()
** Substituted own kobject notification with generic KobjectDispatcher.
** powercontrol_neo: Use bind/unbind way of controlling ar6k power to get the maximum power saving. This obsoletes wireless.pyx. At this point of time we no longer require Cython.

* oeventsd
** Serialize dbus requests with a Queue. This (and removing a race in the RingToneAction) should fix the problems with neverending vibration and audio ringtone on short calls

* ouseaged
** org.freesmartphone.Usage.Suspend() now returns a value instead of timing out (call did not return before the actual suspend was triggered). As an inherent result, the suspend now occurs asynchronous.
** Added org.freesmartphone.Usage.[Shutdown|Reboot]() -> ()
** Send signal org.freesmartphone.Usage.SystemAction() before suspending, after resuming, before shutting down, before rebooting.
** Disabled resource on shutdown.
** Check resume reason and launch emergency shutdown, if we woke up due to low battery. NOTE: This is only supported on Openmoko devices now. As there is no standard infrastructure for that in the kernel, we have to deal with device-specific solutions in lowlevel.py
** Add config option 'sync_resources_with_lifecycle' for specifying whether all Resources should be disabled on "startup", "shutdown", "always" (default), or "never".

* opimd
** Fixed dbus objects not appearing since they were registered on the initial dbus connection, the subsystems use individual connections though.

* onetworkd
** Simple connection sharing now works

* otimed
** Add simple timesync to NTP and GPS
** Add config options for time and zone sources. Set to "NONE" to disable this feature.

* misc
** We now register one dbus connection per subsystem to prevent objects appearing on all bus names. If you previously only used the bus name 'org.freesmartphone.frameworkd', you have to adjust your code.

* zhone
** Add gettext support
** Add russian translation
** Send and receive USSD messages
** Show error/warning when SIM is full
** Simple GSM cell monitor
** Revamped GPS monitor
** Display current timezone
** Try unlocking the screen on incoming calls
** Show the name from the phonebook during call

===Installation===

# Grab a uImage and a .jffs2 for your device from freesmartphone.org's download [http://downloads.freesmartphone.org/fso-stable/milestone5/ section].
# Flash it to your [[Flashing the Neo 1973|Neo 1973 (om-gta01)]] or [[Flashing the Neo Freerunner|Neo FreeRunner (om-gta02)]] with [[Dfu-util| dfu-util]].
# Boot and wait until the Zhone main window appears.
# ''If the [[Zhone]] main window does not appear on first boot or stays with "connecting to dbus..." longer than 1 minute, then please reboot. The base system still has some problems with dbus starting for the first time''
# Read the [[FSO UI Tutorial]] and have fun. Note though that this has not been updated yet for milestone 5 (which looks a bit differently and has more features).

===What you can expect from this release===

* Telephony
* Phonebook
* SMS
* Messagebook
* GPS
* frameworkd implementing the following dbus APIs:
** org.freesmartphone.GSM.*
** org.freesmartphone.Device.*
** org.freesmartphone.Usage
** org.freesmartphone.Resource
** org.freesmartphone.Events
** org.freedesktop.Gypsy

===What we expect from you===

* Feedback and comments for the dbus APIs. This is your chance to take an active role into shaping the application programming interface for all your forthcoming cool applications.

* Focus on using the services. Zhone is just our testing-UI and bears little functionality. It's the services that matter.

* The best way to interact with the framework is by exploring the dbus APIs. For that you can use these two tools, which are already installed:
** [[OpenmokoFramework/mdbus|mdbus]] -- a dbus introspection and interaction utility,
** [[OpenmokoFramework/cli|cli-framework]] -- a python dbus command line interface.

* Before reporting bugs against the framework, please try with cli-framework to see whether it's really a problem of the framework or rather the UI (which gets much less attention from us).

* If you want to interact with the GSM modem, while the frameworkd is running, you can use [[OpenmokoFramework/mickeyterm|mickeyterm]] -- a MUXer-aware minimal terminal emulator.

===Best way to hand us debug logs===
# log in via ssh
# killall python
# edit /etc/frameworkd.conf and add to the frameworkd section:
## log_level = DEBUG
## log_to = file
## log_destination = /somewhere/where/you/have/space (preferably SD or NFS, etc.)
# Read our [http://git.freesmartphone.org/?p=framework.git;a=blob;f=conf/example/frameworkd.conf documented frameworkd.conf] configuration file to learn about the other options.
# relaunch frameworkd (/etc/init.d/frameworkd stop; /etc/init.d/frameworkd start)
# log in via ssh (yes, again)
# export DISPLAY=:0.0
# run your favourite client (zhone, cli-framework, ...)

Attach the logs to the tickets, please.

==What's next==

* PIM
* Networking
* Unit Tests
* High Level Documentation
* More Device Support (GTA03, HTC)

==The Team==

Mickey, Jan, Daniel, Stefan.

[[Category:Community Update]]
[[Category:Framework]]
