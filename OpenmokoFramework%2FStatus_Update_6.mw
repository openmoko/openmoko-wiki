<div style="text-align: center; font-weight: bold; font-size: x-large; margin-bottom:1em">Openmoko Framework Team Status Report 2009.2.2</div>

Hi guys! This is the sixth Openmoko Framework Team Status update, featuring our fifth milestone release and more.

For the general motivation, the goals, and the way we are doing our work, please see [[OpenmokoFramework]].

{{FSO}}


== People & Organization ==

== DBus APIs ==

All the public DBus API are documented on the official [http://docs.freesmartphone.org freesmartphone.org API reference] site.
DBus Introspection XML files are available in the [http://git.freesmartphone.org git tree].

* The GSM API (org.freesmartphone.GSM.*) has proven very solid and will be tagged 0.9 before the next milestone.

* The Device API (org.freesmartphone.Device.*) has received some additions for power management and starts stabilizing.

* The Usage API (http://docs.freesmartphone.org/org.freesmartphone.Usage.html) which was merely a reference counting wrapper over the Device API has gained two companions:
** The Resource API (http://docs.freesmartphone.org/org.freesmartphone.Resource.html) turns this into a full-blown resource management system with choosable policies etc.
** The [http://git.freesmartphone.org/?p=specs.git;a=blob_plain;f=html/org.freesmartphone.Usage.html;hb=HEAD#Suspend Suspend] call is resource-aware and gives all resources a chance to prepare for a suspend and to recover after a suspend.

* org.freesmartphone.Objects.ListObjectsByInterface is using DBus-introspection now.

* The Events subsystem has gained an experimental [http://git.freesmartphone.org/?p=specs.git;a=blob_plain;f=html/org.freesmartphone.Events.html;hb=HEAD DBus interface] to add and remove rules and to test triggers.

== Implementations ==

'''Freesmartphone.org Framework Image -- '' (Milestone V)'''

This is the fifth milestone release of the framework and the framework testing application 'Zhone'. With the forthcoming release of other FSO API consumers, Zhone is going to be faded out. Further framework milestone releases will ship in two forms:
# fso-console-image: An FSO-compliant image featuring no user interface manager.
# fso-illume-image: An FSO-compliant image featuring the X-Window system with the Enlightenment-based Illume window manager.

===Thanks===

Thanks to all our contributors, especially the testers and the people who build stuff on top of the freesmartphone.org APIs. Thanks, guys!

===Purpose===

A lightweight image that turns an Openmoko phone into a featurephone and that serves as the basis for further application development using the freesmartphone.org dbus APIs.

=== What's new since Milestone IV ===

'''Note: These are only the highlights. See the [http://git.freesmartphone.org gitweb] commit logs for the gory details...'''

* ogsmd
** Implement org.freesmartphone.GSM.Network.GetCountryCode() -> ss
** Revamped callhandling. Refactored the state-based call handler from TI Calypso (and Freescale Neptune) into a generic class that will be used from all modem abstractions. Ported singleline to use the new call handler. More tests needed for TI Calypso and Freescale Neptune.
** Start with CINTERION MC75 support
** Implement org.freesmartphone.GSM.Device.[Get|Set]SpeakerVolume
** Implemented org.freesmartphone.GSM.Device.[Get|Set]MicrophoneMuted
** Added 'cid' and 'lac' results to org.freesmartphone.GSM.Network.GetStatus()
** Implemented org.freesmartphone.GSM.SIM.GetIssuer() NOTE: Clients can now show the Mobile Virtual Network Operator instead of the actual service provider, if they want to.
** Added codeToOperator function and a mobile network operator database
** [FREESCALE NEPTUNE] Query our MNO database to show the alphanumeric operator name.
** Implemented org.freesmartphone.GSM.PDP.NetworkStatus()
** Implemented org.freesmartphone.GSM.PDP.GetNetworkStatus()
** Implemented org.freesmartphone.GSM.Network.TimeZoneReport()
** Refactored PDP handling for more stability
** Implemented org.freesmartphone.GSM.Phone.[Start|Stop]AutoRegister() and its signal org.freesmartphone.GSM.Phone.ServiceStatus() This is a convenient way to ensure that ogsmd always tries to unlock the SIM and register with a provider, if necessary. (Corresponding functionality for Gprs is under discussion).
** Create qualcomm_msm modem abstraction based on singleline with minimal changes.
** Added network access type to Provider Info (WARNING, breaks API!)
** Support for Ericsson F3507g modem (as found in Thinkpads)
** Preliminary support for Option UMTS cards
** Refactored Modem.dataOptions() into "pppd-configuration" attribute in modem data storage.
** Added TI-Calypso specific configuration option "ti_calypso_dsp_mode" to configure audio enhancements. Documentation for this option has been added to the sample configuration file.
** Implemented org.freesmartphone.GSM.Monitoring.* as stub erroring out with org.freesmartphone.GSM.UnsupportedCommand.
** [TI CALYPSO] Implemented the new monitoring API: org.freesmartphone.GSM.Monitoring.Get{Serving|Neighbour}CellInformation
** [TI CALYPSO] DSP command gets now resent before call setup.
** Implemented org.freesmartphone.GSM.Phone.StartAutoOnline(apn, user, password) This works the same way as StartAutoRegister(pin), trying to keep the connection online.

* ogpsd

* odeviced
** Added kernel26 option called 'fb_blank' (default=1). If you suffer from the Om bug WSOD (white screen of death), try setting this option to 0.
** Added two new resources: 'CPU' and 'Display': Requesting the CPU resource will prevent the idle notifier from falling into the 'suspend' state, requesting the Display resource will prevent the idle notifier from falling into the 'idle_dim' (and following) state(s). With these two resource, it now takes only one additional rule to prevent the system from suspending while on a call or a musicplayer is playing. 
** Implemented org.freesmartphone.Device.LED.SetNetworking(s,s) -> ()
** Substituted own kobject notification with generic KobjectDispatcher.
** powercontrol_neo: Use bind/unbind way of controlling ar6k power to get the maximum power saving. This obsoletes wireless.pyx. At this point of time we no longer require Cython.

* oeventsd
** Serialize dbus requests with a Queue. This (and removing a race in the RingToneAction) should fix the problems with neverending vibration and audio ringtone on short calls

* ouseaged
** org.freesmartphone.Usage.Suspend() now returns a value instead of timing out (call did not return before the actual suspend was triggered). As an inherent result, the suspend now occurs asynchronous.
** Added org.freesmartphone.Usage.[Shutdown|Reboot]() -> ()
** Send signal org.freesmartphone.Usage.SystemAction() before suspending, after resuming, before shutting down, before rebooting.
** Disabled resource on shutdown.
** Check resume reason and launch emergency shutdown, if we woke up due to low battery. NOTE: This is only supported on Openmoko devices now. As there is no standard infrastructure for that in the kernel, we have to deal with device-specific solutions in lowlevel.py
** Add config option 'sync_resources_with_lifecycle' for specifying whether all Resources should be disabled on "startup", "shutdown", "always" (default), or "never".

* opimd
** Fixed dbus objects not appearing since they were registered on the initial dbus connection, the subsystems use individual connections though.

* onetworkd
** Simple connection sharing now works

* otimed
** Add simple timesync to NTP and GPS
** Add config options for time and zone sources. Set to "NONE" to disable this feature.

* misc
** We now register one dbus connection per subsystem to prevent objects appearing on all bus names. If you previously only used the bus name 'org.freesmartphone.frameworkd', you have to adjust your code.

* zhone
** Add gettext support
** Add russian translation
** Send and receive USSD messages
** Show error/warning when SIM is full
** Simple GSM cell monitor
** Revamped GPS monitor
** Display current timezone
** Try unlocking the screen on incoming calls
** Show the name from the phonebook during call

===Installation===

# Grab a uImage and a .jffs2 for your device from freesmartphone.org's download [http://downloads.freesmartphone.org/fso-stable/milestone5/ section].
# Flash it to your [[Flashing the Neo 1973|Neo 1973 (om-gta01)]] or [[Flashing the Neo Freerunner|Neo FreeRunner (om-gta02)]] with [[Dfu-util| dfu-util]].
# Boot and wait until the Zhone main window appears.
# ''If the [[Zhone]] main window does not appear on first boot or stays with "connecting to dbus..." longer than 1 minute, then please reboot. The base system still has some problems with dbus starting for the first time''
# Read the [[FSO UI Tutorial]] and have fun. Note though that this has not been updated yet for milestone 4 (which looks a bit differently and has more features).

===What you can expect from this release===

* Telephony
* Phonebook
* SMS
* Messagebook
* GPS
* frameworkd implementing the following dbus APIs:
** org.freesmartphone.GSM.*
** org.freesmartphone.Device.*
** org.freesmartphone.Usage
** org.freesmartphone.Resource
** org.freesmartphone.Events
** org.freedesktop.Gypsy

===What we expect from you===

* Feedback and comments for the dbus APIs. This is your chance to take an active role into shaping the application programming interface for all your forthcoming cool applications.

* Focus on using the services. Zhone is just our testing-UI and bears little functionality. It's the services that matter.

* The best way to interact with the framework is by exploring the dbus APIs. For that you can use these two tools, which are already installed:
** [[OpenmokoFramework/mdbus|mdbus]] -- a dbus introspection and interaction utility,
** [[OpenmokoFramework/cli|cli-framework]] -- a python dbus command line interface.

* Before reporting bugs against the framework, please try with cli-framework to see whether it's really a problem of the framework or rather the UI (which gets much less attention from us).

* If you want to interact with the GSM modem, while the frameworkd is running, you can use [[OpenmokoFramework/mickeyterm|mickeyterm]] -- a MUXer-aware minimal terminal emulator.

===Best way to hand us debug logs===
# log in via ssh
# killall python
# edit /etc/frameworkd.conf and add to the frameworkd section:
## log_level = DEBUG
## log_to = file
## log_destination = /somewhere/where/you/have/space (preferably SD or NFS, etc.)
# Read our [http://git.freesmartphone.org/?p=framework.git;a=blob;f=conf/example/frameworkd.conf documented frameworkd.conf] configuration file to learn about the other options.
# relaunch frameworkd (/etc/init.d/frameworkd stop; /etc/init.d/frameworkd start)
# log in via ssh (yes, again)
# export DISPLAY=:0.0
# run your favourite client (zhone, cli-framework, ...)

Attach the logs to the tickets, please.

==What's next==

* PIM
* Networking
* Unit Tests
* High Level Documentation
* More Device Support (GTA03, HTC, EZX)

==The Team==

Mickey, Jan, Daniel, Stefan.

[[Category:Community Update]]
[[Category:Framework]]
