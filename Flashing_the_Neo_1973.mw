This describes how to update your openmoko to the latest software. We'll update the kernel, the root filesystem and the u-boot (new uboot is neccessary, because otherwise you get kernel crashes later -- with phase0 uboot, anyway).

Neccessary files are at http://buildhost.openmoko.org/tmp/deploy/images/ .

Get:
* [[dfu-util]]
* openmoko-devel-image-fic-gta01-20070501054014.rootfs.jffs2
* uImage-2.6.21.1-moko10-r0_0_1883_0-fic-gta01.bin
* for phase 0 (Bv03) phones:
** u-boot-gta01bv3-r5_9877d7dcd1eebe61aa5d8b8ffe9c048ea426e6f6_0_1910.bin 
* for phase 1 phones, uboot update should not be neccessary.

You may want to take the latest versions.

You'll need to boot your openmoko into uboot menu (hold AUX button while pressing power button). Unplug all other usb devices from the host. Plug the phone directly into the host not via a hub.

Double check that u-boot matches your hardware version. Flashing u-boot is really a critical part. You probably only want to do that on phase0 phones.

To update u-boot:
 ./dfu-util -a 1 -R -D u-boot-gta01bv3-r5_9877d7dcd1eebe61aa5d8b8ffe9c048ea426e6f6_0_1910.bin 

To update the kernel:
 ./dfu-util -a 3 -R -D ./uImage-2.6.21.1-moko10-r0_0_1883_0-fic-gta01.bin

To update the root filesystem:
 ./dfu-util -a 5 -R -D ./openmoko-devel-image-fic-gta01-20070501054014.rootfs.jffs2

...now, you'll end up with system that boots, but does not see audio/SD card. You'll need to download corresponding modules.tgz and copy them over to openmoko.

Old versions of uboot are buggy: You may have to press the aux button few times so that machine does not sleep while flashing. It also does not erase rootfs before flashing it... to do that, do minicom /dev/ttyACM0, then nand erase clean rootfs . Unfortunately, old versions of uboot are not really usable, because they fail to enable high 64MB of RAM, and you get nasty crashes after kernel boots.

Good luck!
