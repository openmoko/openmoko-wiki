{{Languages|SHR User Manual}}
 {| align="right"
  | __TOC__
  |}

==SHR Introduction==

Welcome to '''[[SHR]]''', a community driven distribution for (not only) Openmoko Neo phones.

[[Image:SHR-Logo.png|200px|thumb|center|SHR]]

{{Note|As SHR doesn't provide testing images at the moment this manual was based on unstable images available on the beginning of August 2009. The unstable images get changed very often - the download location changes, default applications change, bugs get hunted and fixed, meaning that some parts of this manual are already outdated.
Some users write their SHR experiences on their user page:
* [[User:Klaszlo|Klaszlo]]}}

'''SHR'''  (Stable Hybrid Release) is here to provide you with Root FileSystem images that you can easily install onto your phone to use as a daily phone.  There are many prepackaged programs available that can be installed upon demand by users, it can also be used by developers as a base image for customized and flavored distribution or release. SHR unstable is a testing environment before software get stabilized and it is the main testing ground for [[FSO]] releases. SHR testing images (currently not available) provide as much stability as possible for day-to-day usage.

SHR users, readers of this manual, please report improvements, discrepancies or missing features on this page to <tt>vanous @ penguin . cz</tt>. Thank you.

[http://shr-project.org SHR Project page]

==Installation==

===Getting SHR===

First, determine which model of phone you have, the GTA01 (Neo 1973) or the GTA02 (Neo FreeRunner).

You need to download two files for your version as above: kernel and root filesystem. Depending whether you will be installing into the internal [[NAND memory]] or on [[µSD]] card, you need to either get .jffs2 file for NAND or .tar.gz file for µSD.

For the GTA02 Neo FreeRunner you need to download the images of the testing image from http://build.shr-project.org/shr-testing/images/om-gta02/ - or the unstable release from http://build.shr-project.org/shr-unstable/images/om-gta02/

- Get the latest kernel from the above linkpage. Starts with uImage-...

- Get the root filesystem, for NAND: full-om-gta02.jffs2,  for µSD: full-om-gta02.tar.gz

The above are '''full''' images. You can also choose images with less packages, marked as '''lite''' which can be upgraded to the full image by running

 opkg update
 opkg install task-shr-apps task-shr-games task-shr-gtk

- '''Get the kernel modules.''' From the same page, download the modules to match your kernel (their dates should be the same). Put that file on the FreeRunner and run

 gzip -dc modules-...tar.gz | tar -xf - -C /
 depmod -a

Editors note: Running depmon should not be necessary, if it's needed, please report a bug. Recommending of the depmod command will be removed in near future.

GTA01 images are at (20091130 future):
*http://build.shr-project.org/shr-unstable/images/om-gta01/

===Installation on Flash===

In order to install your SHR distribution directly to your Freerunner Flash memory (NAND), you need to get the desired filesystem file ( <tt>.jffs2</tt> ) as described above and flash your device using the <tt>dfu-util</tt> tool.

Please visit [[Flashing the Neo FreeRunner]] for more details about flashing and see [[Dfu-util]] for detailed information about the dfu-util.

Commands to flash the filesystem and the kernel:

for the Neo FreeRunner:

 sudo dfu-util -d [[USB Product IDs|0x1d50:0x5119]] -a rootfs -R -D full-om-gta02.jffs2
 sudo dfu-util -d [[USB Product IDs|0x1d50:0x5119]] -a kernel -R -D uImage-om-gta02-latest.bin

for the Neo 1973:

 sudo dfu-util -d [[USB Product IDs|0x1457:0x5119]] -a rootfs -R -D full-om-gta01.jffs2
 sudo dfu-util -d [[USB Product IDs|0x1457:0x5119]] -a kernel -R -D uImage-om-gta01-latest.bin

===Installation on µSD Card===

Installing SHR on your µSD Card depends on the Bootloader you are using, ''uBoot'' or ''Qi''.

In simply words, difference between both systems resides on how you must prepare your µSD Card and files you use to fill them:

* If you use ''uBoot'', you need to create two partitions. First partition, not so big, in FAT16 or ext2 where you have to place the kernel file (<tt>uImage-om-gta02-latest.bin</tt>) and second partition in ext2 or ext3 where you have to uncompress the filesystem file (<tt>shr-image-om-gta02.tar.gz</tt>).

* If you use ''Qi'', you only need an ext2 partition into your µSD Card where you uncompress the filesystem image file (<tt>shr-image-om-gta02.tar.gz</tt>). In this case Qi Bootloader is going to look for the kernel image into the <tt>/boot</tt> directory for file named <tt>uImage-GTA02.bin</tt> .

Please visit links below for detailed information and tips:
*For [[Booting from SD | uBoot]] and for [[Qi]].

===SHR version===

Should you ever later wonder what version of SHR you have actually installed, please run

 cat /etc/shr-version

or check SHR Settings -> Other -> Image information

===Booting===
Press the power button shortly to start the phone. The booting splash screen will appear. The first boot after a new installation always takes a bit longer. It is recommended to reboot after this first boot, to make sure all packages got initialized properly.

[[Image:Shr-boot-preview.png|200px|thumb|center|SHR Boot Splash screen]]

===Initial Setup===

On the first boot, Setup is automatically initiated to walk the user through basic setup of the Enlightenment desktop environment.  You are able to choose preferred language of the desktop environment, Illume SHR themed profile or select default menu (only one at the moment). 

On the Add icon screen you can add icons for some application. If you add a terminal based application like mplayer, you will see an icon but no application running upon click, as it will run in the background. 
Last screen allow settin up quick launch applications.

{| class="wikitable"
| [[Image:SHR-Setup-Language.png|200px|thumb|Initial setup]]
| [[Image:SHR-Setup-Profile.png|200px|thumb|Theme profile]]
| [[Image:SHR-Setup-Menu.png|200px|thumb|Menu]]
| [[Image:SHR-Setup-Add-Icons.png|200px|thumb|Add icons]]
| [[Image:SHR-Setup-Quick-Launch.png|200px|thumb|Quick launch]]
|}

==Running SHR==

===SIM Auth===

[[Image:SHR-SIM-Auth.png|200px|thumb|center|SIM Auth]]
SIM Pin is asked for upon start up.

===First look===
[[Image:SHR-First-Look.png|200px|thumb|Desktop screen]]
'''Illume desktop''' is the default home screen of the SHR desktop. Application files located in /usr/share/applications are displayed here. All applications are ran fullscreen and you can switch between them by using the Task switcher in the top shelf or by using the '''<''' left or right '''>''' arrows in the top shelf.

===Phone applications===

Besides other software, SHR comes with 4 main phone applications: ''Dialer'', ''Contacts'', ''Messages'' and ''Phone log''.

{| class="wikitable" cellspacing="0" cellpadding="0" style="padding: 0%; margin:0em 0em 1em 0em; border:1px solid #c0c0c0; background:#eeeeee; floating="center";width:100%; "

! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:25% " |  
[[Image:SHR-Dialer.png|200px|thumb|Dialer]]
! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:25% " |
[[Image:SHR-Contacts.png|200px|thumb|Contacts]]
! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:25% " |
[[Image:SHR-Contacts-Options.png|200px|thumb|Contact options]]
! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:25% " |
[[Image:SHR-Contact-Add.png|200px|thumb|Add new contact]]
|}

{| class="wikitable" cellspacing="0" cellpadding="0" style="padding: 0%; margin:0em 0em 1em 0em; border:1px solid #c0c0c0; background:#eeeeee; floating="center";width:100%; "

! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:25% " |  
[[Image:SHR-Mesages.png|200px|thumb|Messages]]

! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:25% " |

[[Image:SHR-Messages-Options.png|200px|thumb|Messages options]]

! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:25% " |
[[Image:SHR-Message-View.png|200px|thumb|View message]]

! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:25% " |
[[Image:SHR-Message-View-chars.png|200px|thumb|Unicode support]]

|}

{| class="wikitable" cellspacing="0" cellpadding="0" style="padding: 0%; margin:0em 0em 1em 0em; border:1px solid #c0c0c0; background:#eeeeee; floating="center";width:100%; "

! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:25% " |  
[[Image:SHR-Mesages-Options.png|200px|thumb|Message options]]

! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:25% " |

[[Image:SHR-Phonelog.png|200px|thumb|Phonelog]]

! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:25% " |

[[Image:SHR-Dialer-Active.png|200px|thumb|Active call]]

|}

Upon a missed call or an unread message there is a notifier that presents a screen with button to run Messages or Phonelog application, or you can simply close the Notifier with the Top Shelf cross.



===First steps===

Right after installation and first boot you might want to do a few initial steps:
====Network Connection====
''Establish network connection'' and SSH into your phone. The <tt>root</tt> account uses no password by default. You can establish connection either via USB to your desktop and enable NAT or you can connect through Wifi. If you use USB, some setup is required on the desktop side, please read [[USB_Networking]]. For Wifi, you can use [[#Network manager|Network Manager]]

====GSM Network====
''Check if GSM is working correctly'' - observe the GSM gadget in the Top Shelve and see reported signal of your GSM operator. If GSM Gadget seems not be running, click ''Settings'' and later on ''Phone''. Move ''GSM Antenna'' to ''On''.

====Audio: Volume====
''Check and set call volume'' - this is handled by alsa state files in <tt>/usr/share/shr/scenarii/</tt> . To customize speaker volume edit <tt>/usr/share/shr/scenarii/gsmhandset.state</tt> and change <tt>control 4</tt>. Values between from 105 to 120 might be sufficient:

 vi /usr/share/shr/scenarii/gsmhandset.state
or post 091204?
 vi /etc/freesmartphone/alsa/default/gsmhandset

 	control.4 {
 		comment.access 'read write'
 		comment.type INTEGER
 		comment.count 2
 		comment.range '0 - 127'
 		iface MIXER
 		name 'Speaker Playback Volume'
 		value.0 116
 		value.1 116
 	}

Should you want to alter more parameters be aware that each file is a set of value for the 94 parameters. Some of the important ones are:

 Control 48: internal mic of the tel (set to 2 or 3)
 Control 4 : internal speaker (set from 110 to 120)
 Control 49: headset mic
 Control 3 : headset speaker

====Initializing the opkg database====
''Initialize the opkg database'' in order to install some applications from SHR repositories or from other sources, for example [[http://opkg.org opkg.org]]. While still being online, you need to first run

 opkg update

Searching in the opkg database can take a long time. You can speed things up by dumping the database into a file and grepping it through.

Do this only once or after every opkg update:

 opkg list > packages.txt

Then you can search quickly for package name, for example for navit:

 grep navit packages.txt



====SwapSpace====
{{Main|SwapSpace}}
When the RAM is used up, applications get killed. This is particularly bad while doing opkg upgrade. Therefore you might want to create a swap space. Read [[SwapSpace]]

====Changing root password====

Recent images will show up a prompt to change the root password during the first boot wizard.
If for some reason this prompt doesn't show up you can change the password by using the terminal emulator in your SHR installation.

For older images,
SHR is shipped without root password (just press enter)

This is very dangerous if you connect using wifi, or USB. You need to activate the root password:

 passwd

then type your selected password (2 times)


A much more convenient way might be to install your public-key to ~/.ssh/authorized_keys. You can find your public-key of you host at location:

  /path/file 

For running 
 cmd | ssh root@neo anycommand
from your host this might be even mandatory, e.g if you want to pipe anything to the ssh.

===Localization===

==== Localize SHR manually ====

[[Image:SHR-Illume-Settings-Languages.png|200px|thumb|Setting Language]]

You can change the language of the SHR desktop environment by using the Settings of Illume. For Example, for Czech language: in the Illume top shelf go to Wrench (Settings) -> Language -> Language Settings -> and choose: Čeština. If your language is not in the menu you can install by using opkg.

You can list all available languages by running:

 opkg list | grep eglibc-locale-

And install the language of your choice (for example czech):

 opkg install eglibc-locale-cs

After this, the Language Settings of Illume will offer Czech. 

This will localize the Illume environment and will also set correct lang environment variable. If you wish to have translations for other applications, you need to install them again (presuming they are available):

This will install czech localisation for SHR phone applications, SHR Settings and TangoGps:

 opkg install libframeworkd-phonegui-efl-locale-cs shr-settings-locale-cs tangogps-locale-cs

For localized terminal environment (ssh login) set lang variables set /etc/profile, example for Czech language:

 export LANG=cs_CZ
 export LC_ALL=cs_CZ


The Illume keyboard offers english dictionary correction by default. You can list all the dictionaries available for installation:

 opkg list | grep illume-dic

If your language is not available and english is bothering you, you can set an empty dictionary:

 echo "" > /usr/lib/enlightenment/modules/illume/dicts/None.dic

By using it, it will get filled by the words you use and after time will start helping and correcting your typing.

[[Image:Illume-keyboards-terminal-dutch-nl-screenshot.png| Dutch terminal virtual keyboard|256px|thumb]]
Furthermore you can install a different keyboard with a layout which fits your language or alternatives for the default keyboards like the numerical one. The localized [[Illume keyboard]]s are available in the SHR repository under the name ''illume-keyboard-LANG''.

Note that sometimes after an upgrade of Illume has taken place, these keyboards have to be installed again before the become available again. Removing these packages will restore the availability of the respective original keyboards.

==== German (and Austria) Language ====
Find a hopefully [[Configure_SHR_for_German-speaking_use|stable SHR German language version]] with Austrian Maps [[Configure_SHR_for_German-speaking_use|here]]. The configuration can be used for any 
German speaking country. The Austrian maps for [[Navit]] can be replaced and Navit is "speaking" German. Navit is configured with a preselect of country "Austria" (see [[Navit]]), There are some differences between dictionary de_AT (Austria) and de_DE (Germany).

===Date and time===

The local timezone is automatically retrieved from the GSM network. Date and time are automatically set from GPS or Network. The easiest way of setting the time for the first time is to run TangoGps (GPS & Map icon) and obtaining GPS fix. Time will then be set automatically after several minutes.

Time can set time also manually.

Via SHR-Settings -> Date/time -> Set time

From linux based desktop:

 ssh root@192.168.0.202 "date -u -s `date -u +%m%d%H%M%Y.%S`"

You can also set the hardware clock to the system time:

 hwclock --systohc

It is possible to instruct framework on how to set the time and timezone in /etc/frameworkd.conf :

 [otimed]
 # a list of time/zone sources to use or NONE
 timesources = GPS,NTP
 zonesources = GSM
 # use an ip address here, otherwise DNS resolution will block
 ntpserver = 134.169.172.1
 
To disable automatic date/zone settings, simply create an empty [otimed] section in /etc/frameworkd.conf

===File transfer===

After you have established network connection, it is very easy to access and transfer files. The easiest solution is to use Konqueror or Nautilus on your desktop computer and type the following on your location bar. This should provide you with a view of the client's file system on Konqueror or Nautilus and you can easily drag-drop and copy-paste files.

    sftp://root@192.168.0.202

===Reporting bugs===

SHR is a work in progress. If you experience issues, please report them back to SHR. With your report provide logs from

 /var/log/ophonekitd
 /var/log/frameworkd

To report a bug, please go to http://shr-project.org/trac/report

Check if the bug is already reported. If not, add a ticket, be as much precise as you can in the title and the description, in what circumstances the issue happened and so on.

==Settings==
===SHR Settings===
[[Image:SHR-Settings-main.png|200px|thumb|SHR Settings]]

SHR Settings is the main setting application of SHR. It provides an easy way of setting up your phone to your liking - from phone related settings, to requesting resources in order to prevent screen dim or suspend (for example while using GPS).

Please refer to [http://wiki.openmoko.org/wiki/FSO_Resources#Automatic_way this wiki page] about a better way to manage preventing screen dim or suspend.

While some settings are persistent over reboots, others are not.

====Main Screen====
The main screen is divided into eight categories, which contain several modules. Every SHR Settings module has a specified task - for example controlling the GSM antenna power, setting the time etc. 

====Settings: Phone====
Here you can set if the GSM antenna is on and if your phone number is shown  when you call someone.

'''GSM'''
In GSM settings you can turn off and on GSM module. After turning off antenna, whole GSM modem is turned off.

To list available providers, click on Operators button. Scanning can take some time. After a while, a list of operators should pop up.

You can't connect to operators marked [forbidden]. After a connection failure, a message is displayed.

Selecting an operator from the list also changes modem registration mode to manual. It won't register to other network, even if some is available and has better signal strengh. To return to automatic mode, click "Automatic" button in operator list.

'''Call'''
{| class="wikitable" cellspacing="0" cellpadding="0" style="padding: 0%; margin:0em 0em 1em 0em; border:1px solid #c0c0c0; background:#eeeeee; floating="center";width:100%; "


! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:50% " |

[[Image:SHR-Settings-Phone.png|200px|thumb|Phone settings]]


! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:50% " | 
 
[[Image:SHR-Settings-List-providers.png|200px|thumb|List providers]]

|}

You can set if your phone number should be displayed to other party. You can either depend on network decision ("By network") or force it manually ("Manual")

'''Phoneutils'''

For the default SHR phone applications to be able to correctly parse incoming calls/messages and match them with your contacts, you will need to set the right country code for your location. (for example 42 for Czech republic) for more info, please go to: http://wiki.openmoko.org/wiki/Phone_Prefixes

'''SIM'''

Here you can view some informations about your SIM card and clean phone and messagebooks.

'''Others'''
 
'''Profile'''

Here you can select the current profile, which the device should use to determine ring tone etc.

'''Current profile'''

Here you can adjust properties of the currently used profile. Available settings: ring tone, ring volume, ring vibration, ring loop, ring length, message tone, message volume, message vibration, message loop, message length.

To change the ring tone, click the "Change" button.

To use your own ring tone, place it in /usr/share/sounds directory.

After selecting a sid tune as the ring tone, there are available controls to select tune number from the file.

This is changing settings in /etc/freesmartphone/opreferences/conf/phone/default.yaml

 ring-volume # Ring Volume control 0 (mini) to ? maxi)
 ring-length # min time for ringtone. Must be greater than the duration of you ringtone
 ring-loop # define the number of loop of ringtone to play
 ring-tone: "ringtone_ringnroll.ogg" # .ogg example
 ring-tone: "Arkanoid_PSID.sid" # .sid example, use default tune
 ring-tone: "Arkanoid_PSID.sid;tune=2" # .sid example, plays the second tune of that

If you like to test a .sid you can play it using this command on the FR:

 gst-launch filesrc location=Arkanoid_PSID.sid ! siddec tune=2 ! alsasink

Note that it's a ! used and not a | to construct the gstreamer pipe command.

{| class="wikitable" cellspacing="0" cellpadding="0" style="padding: 0%; margin:0em 0em 1em 0em; border:1px solid #c0c0c0; background:#eeeeee; floating="center";width:100%; "

! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:50% " |

[[Image:SHR-Settings-Profiles.png|200px|thumb|Profiles]]

! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:50% " | 
 
[[Image:SHR-Settings-Profiles-Ringtones.png|200px|thumb|Ringtones]]

|}

====Settings: Connectivity====

{| class="wikitable" cellspacing="0" cellpadding="0" style="padding: 0%; margin:0em 0em 1em 0em; border:1px solid #c0c0c0; background:#eeeeee; floating="center";width:100%; "

! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:50% " |

[[Image:SHR-Settings-Connectivity.png |200px|thumb|Connectivity top]]

! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:50% " | 
 
[[Image:SHR-Settings-Connectivity2.png |200px|thumb|Connectivity bottom]]
|}


'''WiFi'''

With the "WiFi radio" toggle you can set, if the wifi module is powered. WiFi radio has to be turned on before trying to connect to a WiFi network, unless you try to connect through [[Mokonnect]] which is capable of powering it up.

'''GPRS'''

To enter APN, login and password fields, just click on the actual value (default: "internet"). Keyboard will pop up.
If you don't know APN, login and passwork, ask your provider.}}

{{Note|You can also use Mokonnect to manage your GPRS connection}}

To connect to the GPRS network, just click the "Connect" button. Entered values will be saved after successful connection.

'''USB'''

With this toggle you can switch USB port between device (Neo to PC) or host (device to Neo) modes.

'''Bluetooth'''

To power up Bluetooth module, switch the "Bluetooth radio" toggle to "On". After that, the "Visibility" toggle should arrive - set it to "On" if you want your FR to be visible by other Bluetooth devices on scanning.

====Settings: GPS====

{| class="wikitable" cellspacing="0" cellpadding="0" style="padding: 0%; margin:0em 0em 1em 0em; border:1px solid #c0c0c0; background:#eeeeee; floating="center";width:100%; "


! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:50% " |

[[Image:SHR-Settings-GPS.png |200px|thumb|center|GPS]]

! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:50% " | 
 
[[Image:SHR-Settings-GPS-Satelites.png |200px|thumb|GPS Satelite details]]
|}



'''GPS'''

By default, GPS is turned on only when requested (when you turn on TangoGPS, Navit, omgps or other GPS app). That state corresponds to "Auto" setting. After changing to "Manual", you can force set it to on or off.

'''GPS information'''

This page can be used to monitor GPS status. If some value isn't known, then "unknown" is displayed.

You can also view information about every visible satellite and check, which are used for getting a fix. To do that, click "Satellite details".

'''Remove AGPS data'''
If you experience problems with GPS, turn it off, click "Remove AGPS data" and reboot your Neo.
Assisted GPS ([[aGPS]]) support GPS receiver to find position by non-satellite information.

'''Save downloaded maps of TangoGSP on Memory Card'''

By default, TangoGPS will save your downloaded maps in /home/root/Maps. But it'll be inconvenient if you flashing again. You can change the path of folder Maps into a folder we created in Memory Card by using Config (Map Repositories) of TangoGPS.

Otherwise, if you have a problem that can't change in that way. Don't be upset, there's another way. First you create a folder <tt>Maps</tt> on Memory Card: 
  mkdir /media/mmcblk0/Maps
Then you have to delete folder <tt>Maps</tt> in your home directory (e.g <tt>/home/root/Maps</tt> if it exists. 
  rm -R /home/root/Maps
Then we'll create a symbolic link ("-s") for the created Maps folder on Memory Card in your the home directory of root on the Phone by 
  ln -s /media/mmcblk0/Maps /home/root/Maps
That should be fine. From now, everytime when you download new maps, it'll be saved directly to folder <tt>Maps</tt> on Memory Card.

<i>Note:</i> repeat the second and the third step (remove Maps in home/root and create link) have to be repeated if you want to link to the downloaded maps for TangoGPS after flashing phone.

====Settings: Date/time====

[[Image:SHR-Settings-Date-Time.png |200px|thumb|Date & Time]]

'''Time'''

Here you can view and set the time. By default, the time is just displayed, To adjust it, click on "Set time".

After finishing adjusting, click the "OK" button.

'''Date'''

This module displays the current date.

====Settings: Power====

'''Battery'''

This module displays informations about battery state - charge, voltage, remaining time etc. To update the data, click the "Update" button.

Here you can also force enable 500mA charging.

'''Display'''

With this slider you can easily set the backlight brightness.

{{Note|This setting isn't permanent over sessions. At boot backlight is set back to 100%.}}

'''Power'''

{| class="wikitable" cellspacing="0" cellpadding="0" style="padding: 0%; margin:0em 0em 1em 0em; border:1px solid #c0c0c0; background:#eeeeee; floating="center";width:100%; "

! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:50% " |

[[Image:SHR-Settings-Power.png |200px|thumb|Power]]

! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:50% " | 
 
[[Image:SHR-Settings-Timeouts.png |200px|thumb|Timeouts]]
|}

Here you can turn on or off automatic dimming or suspend after idle timeout (see: Timeouts module)

'''Timeouts'''

Here you can set up values of idle timeouts used by the device. Timeouts are reached in this order: idle -> idle dim -> idle prelock -> lock -> suspend. Idle, idle prelock and lock aren't used by default in SHR at the moment. This setting changes parameters in /etc/frameworkd.conf :

 [fsodevice.kernel_idle]
 suspend = 20
 lock = 2
 idle_prelock = 12
 idle = 10
 idle_dim = 20

====Settings: Services====

{| class="wikitable" cellspacing="0" cellpadding="0" style="padding: 0%; margin:0em 0em 1em 0em; border:1px solid #c0c0c0; background:#eeeeee; floating="center";width:100%; "


! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:50% " |

[[Image:SHR-Settings-Services.png |200px|thumb|center|Services]]

! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:50% " | 
 
[[Image:SHR-Service-restart.png |200px|thumb|Services debug screen]]
|}

Here is listed every interesting script from /etc/init.d/ directory.

After clicking on one, you can either start, restart or stop the service and view the result.

====Settings: Others====

{| class="wikitable" cellspacing="0" cellpadding="0" style="padding: 0%; margin:0em 0em 1em 0em; border:1px solid #c0c0c0; background:#eeeeee; floating="center";width:100%; "


! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:50% " |

[[Image:SHR-Settings-Others.png |200px|thumb|Others]]

! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:50% " | 
 
[[Image:SHR-Settings-Splash-Preview.png |200px|thumb|Splash preview]]
|}

'''Splash'''

With this selector you can select the theme used by shr-splash at boot and shutdown. After clicking "Preview", the selected boot image will be displayed for 5 seconds.

'''PIM'''

Module used by opimd developers. Doesn't have influence on behaviour of default SHR image.

Every opimd domain has different backends to store its data. The domain reads data from every backend and writes data to the default backend. So with the selector in shr-settings you can choose the backend that stores newly generated data, it doesn't copy or move existing data to a different backend.

'''Userspace backups'''

Here you can either archive or restore your files and configurations.

'''Image information'''

This module contains basic information about the installed image - name of buildhost, used revision, branch and time of build.

'''Theming'''
[[Image:SHR-Neo-Theme.png|200px|thumb|Neo theme]]
Find available themes by running 

 opkg list | grep theme-illume

install it by

 opkg install e-wm-theme-illume-sixteen elementary-theme-sixteen

http://opkg.org has a very fast theme called nEo

 opkg install http://www.opkg.org/packages/e-wm-theme-neo_0.2_armv4t.ipk
 opkg install http://www.opkg.org/packages/elementary-theme-neo_0.2_armv4t.ipk
 opkg install http://www.opkg.org/packages/etk-theme-neo_0.2_armv4t.ipk
 opkg install -force-overwrite http://www.opkg.org/packages/libframeworkd-phonegui-efl-theme-neo_0.2_armv4t.ipk

If you also want the GTK+ Applications to fit in with the rest of the Systems look execute

 opkg install http://www.opkg.org/packages/gtk-theme-neo_0.1_armv4t.ipk

For a completely monolithic look additionally execute
 
 opkg install -force-overwrite http://www.opkg.org/packages/gpe-theme-neo_0.1_armv4t.ipk
 opkg install http://www.opkg.org/packages/icon-theme-neo_0.2_armv4t.ipk

Please observe the command line output when installing these themes, since it will tell you how to activate the themes.

{{Note|some of the theme packages have to be reinstalled after an opkg upgrade.}}

Reverting back can be done by 

 opkg install e-wm-theme-illume-sixteen shr-theme-gtk-e17lookalike  -force-reinstall
 opkg install libframeworkd-phonegui-efl0 e-wm-theme-default etk-theme-shr shr-theme -force-reinstall

=== Illume settings ===

The Illume desktop can be easily customized - slide the top shelf down and tap the Settings icon (Wrench).

{{Note|TIP: for better access of the Settings icon, tap and hold the Settings icon, then drag it to the right.}}

'''Illume settings''' (the wrench) provides various options to alter the desktop environment. You can change sizes of elements, single or double click, wallpaper. To access all the various options, open Illume Settings and slide the visible icons to the left, to preview more options on the right hand side.

The little applets in the top shelf (for example Battery, GSM, Bluetooth etc.)  are called '''shelf gadgets''' and you can configure whether they are visible (on the front part of the top shelf) or hidden (you can access them by sliding the top shelf) through Illume Settings -> Display -> Shelf gadget.

Some screens are not resized properly to fit the phone's display - for example the Wallpapper setting. This is a known bug already reported upstream.

<!-- [[Image:SHR-Top-Shelve.png|200px|thumb|Top Shelf]] -->

==FSO Resources==

FSO is in control of each device. These are called ''resources''. If the software wanting to use the device is capable of requesting this resource via <tt>d-bus</tt>, FSO will do this, otherwise you might need to power the device manually. After the requested resource is released, FSO will power it down. Manual resource request can be done through ''SHR Setting'' or you can use <tt>fsoraw</tt> command. (Using fsoraw is faster and better then running dbus commands)

 opkg install fsoraw

Example of usage fsoraw:

 fsoraw -r Display mokomaze

See [[FSO Resources]] for more details on using the following resources:

'''Wifi'''

Unless this resource is enabled you've no eth0 and wifi module is completely un-powered. Use the network manager to set up networks, [[Mokonnect]] will power Wifi up automatically when needed.

'''Bluetooth'''

You need to have this resource requested to have bluetooth module powered.

'''GPS'''

The fso-gpsd is a daemon waiting for gsmd connections, automatically powering the device on and off. When a connection exists, it powers up the GSM. In SHR Settings you can switch GPS completely off SHR Settings -> GPS -> Manual > Off

'''GSM'''

You need to have this resource requested to have GSM module powered.

'''Display'''

While this resource is requested the display won't be blanked and suspend is disabled.

'''CPU'''

Default rules.yaml checks for this resource to disable automatic suspend when it's requested. While this resource is kept suspend is disabled (but screen can be blanked).

'''Test'''

A test resource

==Network manager==

While there are several ways of networking - Wifi, USB, Bluetooth and Gprs - By default, USB networking is enabled in <tt>/etc/network/interfaces</tt>.

Enhanced configuration is possible through direct editing of /etc/network/interfaces or through [[Mokonnect]].

The <tt>connmand</tt> daemon with Mokonnect are the recommended user level applications for setting up networking. At the moment, Mokonnect can manage USB, Wifi and Gprs connections, as well as routing and NAT. The Wifi device is not required to be manually turned on via SHR-Settings as Mokonnect will automatically enable the device when needed and disable it after use.

{| class="wikitable" cellspacing="0" cellpadding="0" style="padding: 0%; margin:0em 0em 1em 0em; border:1px solid #c0c0c0; background:#eeeeee; floating="center";width:100%; "

! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:33% " |
[[Image:SHR-Mokonnect.png|200px|thumb|Mokonnect]]

! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:33% " | 
 
[[Image:SHR-Mokonnect-Wifi.png|200px|thumb|Mokonnect Wifi]]

! style="background:#fcfcfc;border-left:1px solid #9999cc;border-right:1px ; border-top:2px solid 75d806; border:0px solid #222222; width:33% " | 
 
[[Image:SHR-Mokonnect-Wifi-Scan.png|200px|thumb|Mokonnect Wifi Scan]]


|}

==Bluetooth==

Bluetooth can be used for several different applications - file transfer, networking, HIDD, music playing (A2DP), calling etc. In some occasions, the devices need to be authorized - paired. At the moment, support for some bluetooth functions is better than for others - it is possible to do all mentioned above with the notice that phone calls with bluetooth headset are always routed to the bluetooth even if it is not around, making it quite difficult to use.

Don't forget you need to turn the bluetooth radio on in SHR Settings -> Connectivity -> Bluetooth Radio: On, where you can also make the bluetooth device visible.

SHR uses bluez4 which is completely different from bluez3. The bluetoothd is taking care of most of the bluetooth now. Please see [[Manually using Bluetooth]] for detailed information about using bluetooth and also for a list of supported devices.

===OBEX file transfer===

There are several obex programs allowing file transfer, all in console at the moment. Obexpush installs obextool, and opd daemon:

 opkg install obexpush

Default receiving path (editable in /etc/default/opd_args ) does not exist, so create it

 mkdir /var/obexpush

Files are then received automatically, no notice, no confirmation... they just silently appear in /var/obexpush

To send some files, first scan for devices:

 hcitool scan
 Scanning ...
 	00:16:41:F5:A5:BC	laptop

Then send it onto bt address found in the scan:

 obextool push image.jpg 00:16:41:F5:A5:BC 10

===Connect Bluetooth keyboard===

 hidd --search

Editors note: This is the old bluez3 way, but it works. New bluez4 way will replace this.

===Pairing===

This comes from [[Manually_using_Bluetooth#Once_Again.2C_Bluetooth_Headset_on_Freerunner]]

Now, you must pair the bluetooth headset with your phone. Make sure the bluetooth chip is powered up (can be done through the Connectivity section in the SHR-Unstable settings manager) and that bluetoothd is running:
 /etc/init.d/bluetooth start
Now, to actually pair the bluetooth headset, you will need the simple-agent script. If you already have it, excellent. If you, like me, do not, then you can get it here: http://dl.getdropbox.com/u/453116/simple-agent

Put it in /usr/bin/ and run ===chmod a+x /usr/bin/simple-agent===

Now put your headset into pairing mode and run 

 hcitool scan

Find your headset and use its address in the command 

 simple-agent hci0 XX:XX:XX:XX:XX:XX

If you give a third parameter (what it is doesn't matter) to simple-agent, it will disconnect then reconnect to the headset (reset pairing).



===GSM phone calls with bluetooth headset===

Your bluetooth headset device must be paired first.

====Configuring bluez====

Older SHR releases you need to uncomment <tt>SCORouting=PCM</tt> setting in <tt>[General]</tt> section of

 /etc/bluetooth/audio.conf

like this:

 # SCO routing. Either PCM or HCI (in which case audio is routed to/from ALSA)   
 # Defaults to HCI                                                               
 SCORouting=PCM                                                                  
 
do not forget to restart bluetoothd after that.

 /etc/init.d/bluetooth stop
 /etc/init.d/bluetooth start

====Configuring FSO====

Now we must tell frameworkd that you have a bluetooth headset. Headset parameters should be set in

 /etc/freesmartphone/opreferences/conf/phone/default.yaml

Parameters bt-headset-enabled and bt-headset-address (see opreferences/schema/phone.yaml for semantics).

You need to restart FSO for the changes to take effect.

 /etc/init.d/frameworkd restart

example of my /etc/freesmartphone/opreferences/conf/phone/default.yaml:

 message-length: 7
 message-tone: notify_message.wav
 message-vibration: 1
 message-volume: 10
 ring-loop: 1
 ring-tone: ringtone_ringnroll.wav
 ring-vibration: 1
 ring-volume: 10
 bt-headset-enabled: 1
 bt-headset-address: 00:09:DD:31:92:98

====Re-Connecting the bt device====

You might need to get the bluetooth headset connected manually on the beginning and also after suspend:

 mdbus -s org.bluez /org/bluez/`pidof bluetoothd`/hci0/dev_xx_xx_xx_xx_xx_xx org.bluez.Headset.Connect

where xx_xx_xx_xx_xx_xx is address of the device, for example:

 mdbus -s org.bluez /org/bluez/`pidof bluetoothd`/hci0/dev_00_09_DD_31_92_98 org.bluez.Headset.Connect

Hopefully, your bluetooth headset now works. Good luck!

==System Customizing==

===Changing the splash screen===

list available splash screen themes

 opkg list | grep splash-theme

and install one of the available themes

 opkg install shr-splash-theme-dontpanic

Then go to SHR Settings -> Others -> Themes. Here you can preview installed themes and change the default one.

===Enable mouse cursor=== 

edit line 121 of /etc/X11/Xinit and erase -hide-cursor

 ARGS="$ARGS -dpi ${DPI} -screen ${SCREEN_SIZE} -mouse tslib -root-ppm /usr/share/pixmaps/xsplash-vga.ppm vt1"
            


===Speedup of suspend and wake up===

Some setup types of the bootloader are causing slow suspending and waking up through a long console output. ([http://shr-project.org/trac/ticket/351 bug report]) This occurs when using the the Qi bootloader in combination with an installation on an SD card and when using the u-boot bootloader. 

I you are using Qi and installation on a µSD card, you can change the kernel parameter loglevel=1 in /boot/append-GTA02.

===Opimd utils===

Opimd utils is a set of several testing scripts to play with the new opimd backends. It also provides opimd-messages program and mainly new opimd-notifier 
that is much better then the standard one.

For further Information refer to the corresponding [[Opimd|Wiki Page]].
 opkg install opimd-utils

{{Note| opimd-utils isn't announced yet! It can eat your cat! Don't touch it unless you are opimd developer or you are writing app with opimd support.

'''NOTE 2:''' In order to have sound and vibration on incoming message when using opimd interface, you have to patch oeventsd with patch available at [http://openmoko.opendevice.org/~dos/opimd/oeventsd/]

'''NOTE 3:''' For testing and development opimd recommended distribution is ''upgraded'' SHR unstable.
}}

===opkg upgrade issues===

As '''opkg''' had some '''issues''' recently, installation  might get broken due to that. You can fix it or prevent by using the following scripts

Safe update packages:

 #!/bin/sh
 
 for pkg in `opkg list_upgradable | awk '!/(kernel|Multiple)/ {print $1}'`
 do
 	echo "installing pack $pkg"
 	opkg install $pkg -force-reinstall
 done


Force reinstall all installed packages:

 #!/bin/sh
 
 for pkg in `opkg list_installed | awk '!/(kernel|Multiple)/ {print $1}'`
 do
 	echo "installing pack $pkg"
 	opkg install $pkg -force-reinstall
 done

===Random errors===
No icons, no GSM functions etc. - this is mostly due to '''errors on your µSD''' card. Remove your card and fix it in card reader or by booting to another partition (nand) or by reboot and mount read only, then run fsck.

For reboot into nand and fix 1st partition of ext2 on your card

 fsck.ext2 /dev/mmcblk0p1



===Adding your phone to your hosts=== 

You can add your phone to your hosts file for a name resolving:

You can use the name <tt>neo</tt> if you added the host <tt>neo</tt> in <tt>/etc/hosts</tt> on your desktop computer (add the following line for host <tt>neo</tt> assuming that the IP-address of your phone is <tt>192.168.0.202</tt>.
 echo "192.168.0.202 neo neo" >> /etc/hosts

You can then access your phone like this:

 ssh root@neo

Which is shorter than this:

 ssh root@192.168.0.202

==Installing Software==

You can use opkg for installing software packages or you can try SHR Installer from http://git.shr-project.org/git/?p=shr-installer.git;a=summary . It requires packagekitd

 opkg install packagekitd

If you wan to use opkg after you used the installer, make sure packagekitd is not running

 killall packagekitd 

'''Cool applications'''

SHR comes with only a few preinstalled applications but its repository provides more cool stuff. Also, there are applications that are not in SHR repos at the moment but can still be installed. The following few examples are here just to spark your interest:

'''[[Paroli]]''' is available in SHR images, you can install it:

 opkg install paroli

fix the conf files that the paroli installer messes with (might get fixed in the next couple of days.)

 cp /etc/old_frameworkd.conf /etc/frameworkd.conf
 cp /etc/freesmartphone/oevents/old_rules.yaml /etc/freesmartphone/oevents/rules.yaml

now if you want to disable the shr phone apps without removing them comment all of the lines out in 

 /etc/X11/Xsession.d/89notifier and /etc/X11/Xsession.d/80ophonekitd

if you want the bind-home to ease upgrades add this line to fstab.

 /media/card/bind-home   /home/root     none        bind                   0  0

You should now have a functional paroli on SHR setup. Once you have a working setup I would advise against doing opkg upgrades and only upgrade specific packages when needed.


[[Category:SHR]]
